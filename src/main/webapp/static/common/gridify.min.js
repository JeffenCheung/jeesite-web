/*!
 * Copyright &copy; 2015-2016 <a href="https://pactera.com">Pactera-JeeSite</a> All rights reserved.
 * 
 * 通用列表处理方法
 *
 * 样式操作颗粒度需跟bootstrap一致，到TD/TH的cell一级而非TR一级，否则会被bootstrap的样式覆盖。
 * bootstrap的颗粒度普遍如此设计，或因考虑到方便widget进行单个cell的差异化操作，此标准值得借鉴和沿用。
 *
 * @author Jeffen@pactera
 * @version 2015-9-25
 */
$(document).ready(function(){if(!typeof TITLE_AUTOCOMPLETE_URL==="undefined"){$("#title").autocomplete({autoFocus:true,minLength:1,delay:500,source:function(d,c){$.getJSON(TITLE_AUTOCOMPLETE_URL,d,function(e){c($.map(e,function(f){return{label:f.name,value:f.name}}))})},select:function(c,d){if(d.item){c.preventDefault();$("#title").val(d.item.value);$("#title").blur();$("#title").focus();return false}}})}$("#checkall").on("click",function(){$("#contentTable tbody tr").each(function(c){b($(this),true)});a()});$("input[name='cbRowData']").bind("click",function(){var c=$(this).parent().parent();b(c);a()});$("#contentTable tbody tr").each(function(c){$(this).children("td").each(function(d){var f=$(this);var e=$(this).parent();if(!f.hasClass("row-checkbox")&&!f.hasClass("row-id")&&!f.hasClass("row-operate")){f.bind("click",function(){b(e);a()})}})});hotKeys();function b(d,c){if((!c&&d.hasClass("table-row-selected"))||(c&&!$("#checkall").is(":checked"))){d.removeClass("table-row-selected");d.children().removeClass("table-row-selected");d.children("td:eq(0)").children("input[name='cbRowData']").removeAttr("checked")}else{d.addClass("table-row-selected");d.children().addClass("table-row-selected");d.children("td:eq(0)").children("input[name='cbRowData']").attr("checked","checked").attr("checked",true).prop("checked",true)}}function a(){var e=0;var c=0;var d=$("#contentTable tbody tr").length;$("#contentTable tbody tr").each(function(f){var g=$(this);if(g.hasClass("table-row-selected")){e++}else{c++}});if(d==e&&!$("#checkall").attr("checked")){$("#checkall").attr("checked","checked").parent().attr("title","全不选")}if(d==c&&$("#checkall").attr("checked")){$("#checkall").removeAttr("checked").parent().attr("title","全选")}if(e>0){$("#btnDeleteChecked").removeAttr("disabled").attr("value","删除("+e+")");
$("#btnCopyChecked").removeAttr("disabled").attr("value","复制("+e+")")}else{$("#btnDeleteChecked").attr("disabled",true).attr("value","删除");$("#btnCopyChecked").attr("disabled",true).attr("value","复制")}}});function inputFocus(a){if(a.value==a.defaultValue){a.value="";a.style.color="#000"}}function inputBlur(a){if(a.value==""){a.value=a.defaultValue;a.style.color="#848484"}}function rowDelete(a){var b="";if($("#physicalDelete").attr("checked")){b=" <span class='text-warning'>[注：物理删除]</span>"}top.$.jBox.confirm("确认要删除本条数据吗？"+b,"系统提示",function(c,d,e){if(c=="ok"){$("#gridForm").attr("action",a).submit();top.$.jBox.tip.mess=false}},{buttonsFocus:1});top.$(".jbox-body .jbox-icon").css("top","55px")}function truncateTable(a){top.$.jBox.confirm("确认要清理<span class='text-warning'>(物理删除)</span>所有数据?","系统提示",function(b,c,d){if(b=="ok"){$("#gridForm").attr("action",a).submit();top.$.jBox.tip.mess=false}},{buttonsFocus:1});top.$(".jbox-body .jbox-icon").css("top","55px")}function hotKeys(){$(document).keydown(function(a){if(a.ctrlKey&&a.which==37){$("#prevPage").click()}if(a.ctrlKey&&a.which==39){$("#nextPage").click()}})}$.extend({batPro:function(a,c){var b="";$("#cbRowDataIdsBox").empty();$("#contentTable tbody tr").each(function(e){if($(this).children("td:eq(0)").children("input[name='cbRowData']").attr("checked")){b+=this.id+",";var d=$("<input name='cbRowDataIds' type='hidden' />");d.attr("value",this.id);$("#cbRowDataIdsBox").append(d)}});if(b==""){top.$.jBox.info("请至少选中一条数据进行"+c+"。","操作提示");return}top.$.jBox.confirm("确认要批量"+c+"所选数据吗？如果数据过大，可能需要一些时间。","系统提示",function(d,e,g){if(d=="ok"){$("#gridForm").attr("action",a).submit();top.$.jBox.tip.mess=false}},{buttonsFocus:1});top.$(".jbox-body .jbox-icon").css("top","55px")}});